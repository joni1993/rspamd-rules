# ==============================================================================
# Most viruses and malware hide in attachments.
# Mostly hidden in invoices, orders and other business-related data.
# The documents are usually sent as archive files.
#
# Rspamd already searches for unwanted file extensions.
# Here we supplement the file extensions with other combinations.
#
# ------------------------------------------------------------------------------
# Language: german, english
# Weight:   6.0
# ==============================================================================

# Invoices, orders, etc
# ------------------------------------------------------------------------------
# -> We do not check for the archive file types. PDF files are excluded.

# Does not work. It is not supported by Rspamd.
#/inv(oice)?.?\d{0,10}\.((?!pdf$)[^.]*)/i
#/(receipt|winner).?\d{0,10}\.((?!pdf$)[^.]*)/i

/(inquiry|invoice|order|proforma|quotation|receipt|request).{0,25}\.(7z|gz|r11|r16|rar|tar|zip)/i

/rechnung.{0,25}\.(7z|gz|rar|zip)/i

/docu\.7z/i

# 13.0125 - Sample: re_10_00134873.zip
/re_[0-9_]{4,15}\.zip/i

# 09.01.25 - Sample: DHL Receipt_#7900629801.gz
/#\d{3,15}\.gz/i

# 11.01.25 - Sample: 10201124.zip
/^\d{5,10}\.zip/i

/\d{5,10}\.rar/i

# 16.01.25 - Sample: CCF_001802.zip
/[a-z]\{3}_\d{1,10}\.zip/i

# 16.01.25 - Sample: R_54369_gojak.it.zip
/r_\d{1,10}_.{0,15}\.zip/i

# 18.01.25 - Sample: Rg. Fa. Schophuis.zip
/rg\..{0,5}fa\..{0,15}\.zip/i

# 20.01.25 - Sampple: PO# 4502288112.gz
/po#.{0,25}\.(7z|gz|r16|rar|zip)/i

# 22.01.25 - Sample: RFQ- 2708970-001.gz
/rfq-.{0,15}\.gz/i

# 23.01.25 - Sample: FD_EberleR176612.zip
/fd_.{0,20}\.zip/i

# Pattern
# ------------------------------------------------------------------------------
/detail.{0,10}specification/i
/stock.{0,10}offer/i
/quotation#/i
/quotation.?new/i

/nachricht/i
/new.?order/i

# Extensions
# ------------------------------------------------------------------------------

/\.(r11|r16)$/i

# Double Extension
# ------------------------------------------------------------------------------

# The unique ones
/\.img\.gz/i
/\.(jpg|pdf)\.html/i
/\.(pdf|r09)\.rar/i
/\.xlsx\.t?gz/i

/(,|_)(doc|pdf)\.(htm|svg|tar|zip)/i

/\.pdf\.zip/i

# Triple Extension
# ------------------------------------------------------------------------------
/\.xls\.tar\.gz/i

# Order
# ------------------------------------------------------------------------------
# 31.12.24 - Sample: PO-002144R SITCVN.gz";
/po-\d{2,10}.{0,20}\.gz/i

# 10.01.25
/order\.rar/i

# Parcel
# ------------------------------------------------------------------------------
# 27.12.24 Sample: FedEx AWB# 797187750472.gz
/fedex.{0,20}\.gz/i
/(fedex|express).{0,20}\.gz/i


/fedex_/i
/hermes\.docx?/i
