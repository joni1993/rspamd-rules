# ==============================================================================
# Sender: Checking the envelope "from" and the address
# ------------------------------------------------------------------------------
#
# In order to avoid losing track of large files, the filters are organized
# into different topics. Tracking the sender name has been shown to be effective.
#
# Weighting: LOW:     6 
#            MEDIUM: 12
#            HIGH:   18
#
# In the configuration of SmaterMail we use the scoring factor 1.67 to reach the
# weighting of 10, 20 and 30.
# ==============================================================================

# TLD
# ------------------------------------------------------------------------------
sender.address.tld {
  type = "header";
  header = "from";
  filter = "email:domain:tld";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/lists/list.tld.map";
  score = 2.0;
  symbol = "sender.address.tld";
  description = "Sender Address TLD";
}

#sender.from.tld {
#  type = "header";
#  header = "from";
#  filter = "email:domain:tld";
#  regexp = true;
#  one_shot = true;
#  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/lists/list.map";
#  score = 2.0;
#  symbol = "sender.from.tld";
#  description = "Sender From TLD";
#}

# Generic
# ==============================================================================
sender.address {
  type = "header";
  header = "from";
  filter = "email:addr";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.address.map";
  score = 6.0;
  symbol = "sender.address";
  description = "Sender Address";
}

sender.from.de {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.de.map";
  score = 6.0;
  symbol = "sender.from.de";
  description = "Sender From Generic, German";
}

sender.from.en {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.en.map";
  score = 6.0;
  symbol = "sender.from.en";
  description = "Sender From Generic, English";
}

# Single word
# ------------------------------------------------------------------------------
sender.from.de.singleword {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.de.singleword.map";
  score = 6.0;
  symbol = "sender.from.de.singleword";
  description = "Sender From Single Word, German";
}

sender.from.en.singleword {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.en.singleword.map";
  score = 6.0;
  symbol = "sender.from.en.singleword";
  description = "Sender From Single Word, English";
}

# Organisations, Brands and Products
# ------------------------------------------------------------------------------
sender.from.orgbrandprod {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.orgbrandprod.map";
  score = 6.0;
  symbol = "sender.from.orgbrandprod";
  description = "Sender From Organisations, Brands and Products";
}

# Fake People names
# ------------------------------------------------------------------------------
sender.from.people {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.people.map";
  score = 6.0;
  symbol = "sender.from.people";
  description = "Sender From People";
}

# Specific topics
# ==============================================================================

# Adult
# ------------------------------------------------------------------------------
sender.from.de.adult {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.de.adult.map";
  score = 6.0;
  symbol = "sender.from.de.adult";
  description = "Sender From Adult, German";
}

sender.from.en.adult {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.en.adult.map";
  score = 6.0;
  symbol = "sender.from.en.adult";
  description = "Sender From Adult. English";
}

# Finance, Loans
# ------------------------------------------------------------------------------
sender.from.de.finance {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.de.finance.map";
  score = 6.0;
  symbol = "sender.from.de.finance";
  description = "Sender From Finance, German";
}

sender.from.en.finance {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.en.finance.map";
  score = 6.0;
  symbol = "sender.from.en.finance";
  description = "Sender From Finance. English";
}

# Health
# ------------------------------------------------------------------------------
sender.from.health.medname {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.health.medname.map";
  score = 6.0;
  symbol = "sender.from.health.medname";
  description = "Sender From Health, Medication Names";
}

sender.from.de.health {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.de.health.map";
  score = 6.0;
  symbol = "sender.from.de.health";
  description = "Sender From Health, German";
}

sender.from.en.health {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.en.health.map";
  score = 6.0;
  symbol = "sender.from.en.health";
  description = "Sender From Health, English";
}

# Gambling
# ------------------------------------------------------------------------------
sender.from.de.gambling {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.de.gambling.map";
  score = 6.0;
  symbol = "sender.from.de.gambling";
  description = "Sender From Gambling, German";
}

sender.from.en.gambling {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.en.gambling.map";
  score = 6.0;
  symbol = "sender.from.en.gambling";
  description = "Sender From Gambling, English";
}

# Lottery
# ------------------------------------------------------------------------------
sender.from.de.lottery {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.de.lottery.map";
  score = 6.0;
  symbol = "sender.from.de.lottery";
  description = "Sender From Lottery, German";
}

sender.from.en.lottery {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.en.lottery.map";
  score = 6.0;
  symbol = "sender.from.en.lottery";
  description = "Sender From Lottery, English";
}

# Malware, Virus
# ------------------------------------------------------------------------------
sender.from.de.malware {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.de.malware.map";
  score = 6.0;
  symbol = "sender.from.de.malware";
  description = "Sender From Malware, German";
}

sender.from.en.malware {
  type = "header";
  header = "from";
  filter = "email:name";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/sender/sender.from.en.malware.map";
  score = 6.0;
  symbol = "sender.from.en.malware";
  description = "Sender From Malware, English";
}
