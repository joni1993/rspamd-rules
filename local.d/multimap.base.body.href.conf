# ==============================================================================
# Base: Body - Anchor Tag
# ------------------------------------------------------------------------------
#
# This is about ancor tags in emails. We check for:
# - IP address instead of a domain name
# - Bad TLD's
# - Bad Domains or domain patterns
# - No SSL
# - Path in URLs
# - URL shortener
#
# Weighting: LOW:     6          In the configuration of SmarterMail we use
#            MEDIUM: 12          the scoring factor 1.67 to reach the weighting
#            HIGH:   18          of 10, 20 and 30.
# ==============================================================================

base.body.href.domain {
  type = "url";
  filter = "full";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.domain.map";
  score = 12.0;
  symbol = "base.body.href.domain";
  description = "Base: Anchor tag domain";
}

base.body.href.domain.ip {
  type = "url";
  filter = "full";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.domain.ip.map";
  score = 12.0;
  symbol = "base.body.href.domain.ip";
  description = "Base: Anchor tag ip address";
}

base.body.href.domain.tld {
  type = "url";
  filter = "tld";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/lists/list.tld.map";
  score = 12.0;
  symbol = "base.body.href.domain.tld";
  description = "Base: Anchor tag TLD";
}

base.body.href.domain.pattern {
  type = "url";
  filter = "full";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.domain.pattern.map";
  score = 12.0;
  symbol = "base.body.href.domain.pattern";
  description = "Base: Anchor tag domain pattern";
}

base.body.href.url.nossl {
  type = "url";
  filter = "full";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.url.nossl.map";
  score = 12.0;
  symbol = "base.body.href.url.nossl";
  description = "Base: Anchor tag no SSL";
}

base.body.href.url.path {
  type = "url";
  filter = "full";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.url.path.map";
  score = 12.0;
  symbol = "base.body.href.url.path";
  description = "Base: Anchor tag path";
}

base.body.href.url.shortener {
  type = "url";
  filter = "tld";
  regexp = false;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/lists/list.url.shortener.map";
  score = 12.0;
  symbol = "base.body.href.url.shortener";
  description = "Base: Anchor tag url shortener";
}
