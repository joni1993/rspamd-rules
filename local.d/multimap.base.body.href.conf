# ==============================================================================
# Base: Body - Anchor Tag
# ------------------------------------------------------------------------------
# This is about ancor tags in emails. We check for:
# - IP address instead of a domain name
# - Bad TLD's
# - Bad Domains or domain patterns
# - No SSL
# - Path in URLs
# - URL shortener
#
# Weighting: LOW:     6          In the configuration of SmarterMail we use
#            MEDIUM: 12          the scoring factor 1.67 to reach the weighting
#            HIGH:   18          of 10, 20 and 30.
# ==============================================================================

base.body.href.domain {
  type = "url";
  filter = "tld";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.domain.map";
  score = 12.0;
  symbol = "base.body.href.domain";
  description = "Base: Anchor tag Domain";
}

base.body.href.domain.ip {
  type = "url";
  filter = "tld";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.domain.ip.map";
  score = 12.0;
  symbol = "base.body.href.domain.ip";
  description = "Base: Anchor Tag Domain IP Address";
}

base.body.href.domain.tld {
  type = "url";
  filter = "tld";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/lists/list.tld.map";
  score = 12.0;
  symbol = "base.body.href.domain.tld";
  description = "Base: Anchor Tag TLD";
}

base.body.href.domain.pattern {
  type = "url";
  filter = "full";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.domain.pattern.map";
  score = 12.0;
  symbol = "base.body.href.domain.pattern";
  description = "Base: Anchor Tag Domain Pattern";
}

base.body.href.url.nossl {
  type = "url";
  filter = "full";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.url.nossl.map";
  score = 12.0;
  symbol = "base.body.href.url.nossl";
  description = "Base: Anchor Tag No SSL";
}

base.body.href.url.path {
  type = "url";
  filter = "full";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.url.path.map";
  score = 12.0;
  symbol = "base.body.href.url.path";
  description = "Base: Anchor Tag Path";
}

base.body.href.url.path.filename {
  type = "url";
  filter = "path";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.url.path.filename.map";
  score = 12.0;
  symbol = "base.body.href.url.path.filename";
  description = "Base: Anchor Tag Filename";
}

base.body.href.url.path.wordpress {
  type = "url";
  filter = "full";
  regexp = true;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/base/base.body.href.url.path.wordpress.map";
  score = 12.0;
  symbol = "base.body.href.url.path.wordpress";
  description = "Base: Anchor Tag WordPress";
}

base.body.href.url.shortener {
  type = "url";
  filter = "tld";
  regexp = false;
  one_shot = true;
  map = "https://raw.githubusercontent.com/martinschaible/rspamd-rules/main/maps.d/lists/list.url.shortener.map";
  score = 12.0;
  symbol = "base.body.href.url.shortener";
  description = "Base: Anchor Tag URL Shortener";
}
